<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="piMPC: A Parallel-in-horizon and Construction-free NMPC Solver.">
  <meta name="keywords" content="Model predictive control, quadratic program, ADMM, parallel-in-horizon.">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>piMPC: A Parallel-in-horizon and Construction-free NMPC Solver</title>


  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>

<!--  to support latex -->
  <script type="text/javascript"
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>

</head>
<body>

<!-- home button at the top-->
<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <a class="navbar-item" href="https://drgona.github.io/">
        <span class="icon">
          <i class="fas fa-home"></i>
        </span>
        <span>Home</span>
      </a>
    </div>
  </div>
</nav>


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">piMPC: A Parallel-in-horizon and Construction-free NMPC Solver</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://scholar.google.com/citations?user=628iWmAAAAAJ&hl=en">Liang Wu</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="XXXX">Bo Yang</a><sup>2</sup>,</span>
            <span class="author-block">
              <a href="https://scholar.google.com/citations?user=UcpEexUAAAAJ&hl=en">Yilin Mo </a><sup>2</sup>,</span>
            <span class="author-block">
              <a href="https://drgona.github.io/">Jan Drgona</a><sup>1</sup>,
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>Johns Hopkins University,</span>
            <span class="author-block"><sup>2</sup>Tsinghua University</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://arxiv.org/abs/2601.XXXXX"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://arxiv.org/abs/2601.XXXXX"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/SOLARIS-JHU/piMPC"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>



<section class="section">
  <!-- Abstract. -->
  <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          The alternating direction method of multipliers (ADMM) has gained increasing popularity in embedded model predictive control (MPC) 
          due to its code simplicity and pain-free parameter selection. However, existing ADMM solvers either target general quadratic programming (QP) 
          problems or exploit sparse MPC formulations via Riccati recursions, which are inherently sequential and therefore difficult to parallelize for 
          long prediction horizons. This technical note proposes a novel \textit{parallel-in-horizon} and \textit{construction-free} nonlinear MPC algorithm, 
          termed $\pi$MPC, which combines a new variable-splitting scheme with a velocity-based system representation in the ADMM framework, 
          enabling horizon-wise parallel execution while operating directly on system matrices without explicit MPC-to-QP construction.
          Numerical experiments and accompanying code are provided to validate the effectiveness of the proposed method.
          </p>
        </div>
      </div>
    </div>
  </div>
<!--/ Abstract. -->
</section>


<!-- paper summary -->
<section class="section">
  <div class="container is-max-desktop">


<!-- Problem Formulation -->
<div class="columns is-centered">
  <div class="column is-full-width">
    <h2 class="title is-3">Problem Formulation</h2>
    <div class="content has-text-justified">
      XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX 
      XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX.

     <br>
      XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX
     <br>
      <div style="text-align: center;">
        $$
        \min_{U,X}&~ \sum_{k=0}^{N-1}\frac{1}{2}\|Cx_{k+1}-r_y\|_{W_y}^2 + \frac{1}{2}\|u_k- r_u\|_{W_u}^2\\
        \text{s.t.}&~ x_{k+1} = A_{t,k}x_{k} + B_{t,k}u_k + e_{t,k},~\forall k\in\mathbb{N}_{0}^{N-1}\label{eqn_MPC_b}\\
        &~ (x_{k+1},u_{k})\in\mathcal{X}\times \mathcal{U}, ~\forall k\in\mathbb{N}_{0}^{N-1}\label{eqn_MPC_c}\\
        &~ x_0 = x(t),\label{eqn_MPC_d}
        $$
      </div>
      <br>
      where \( x(t) \in \mathbb{R}^{n_x} \) are the differential states, \( y(t) \in \mathbb{R}^{n_z} \) are algebraic states, \( u(t) \in \mathbb{R}^{n_u} \) are known inputs, and \( \theta_f \) are the learnable parameters.
    </div>
  </div>
</div>


<!-- Method -->
<div class="columns is-centered">
  <div class="column is-full-width">
    <h2 class="title is-3">Method</h2>
    <div class="content has-text-justified">
      XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX

      <br>
      XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX XXXX is defined as:
      <br>
      <div style="text-align: center;">
        $$
        \begin{aligned}
            y^{(t+\Delta t)} & = h\left( x^{(t)}, y^{(t)}, u^{(t)}; \theta_h \right), \\\\
            x^{(t+\Delta t)} &= \text{ODESolve}\left(f, \{ x^{(t)}, y^{(t+\Delta t)}, u^{(t)} \}; \theta_f \right),
        \end{aligned}
        $$
      </div>
      <br>
      where \( h: \mathbb{R}^{n_x} \times \mathbb{R}^{n_y} \times \mathbb{R}^{n_u} \rightarrow \mathbb{R}^{n_y} \)
      is a neural surrogate for the algebraic update,
      \( f: \mathbb{R}^{n_x} \times \mathbb{R}^{n_y} \times \mathbb{R}^{n_u} \rightarrow \mathbb{R}^{n_x} \) is a neural ODE model,
      and \(\text{ODESolve}\) denotes a numerical ODE solver (e.g., explicit Runge-Kutta).

      <br>
      This architecture enables end-to-end training of neural DAEs with a constraint-aware loss function:
      <br>
      <div style="text-align: center;">
        $$
        \mathcal{L}(\Theta) = \lambda_1 \mathcal{L}_{\text{residual}}(X, \hat{X}; \Theta)
        + \lambda_2 \mathcal{L}_{\text{constraints}}(X, \hat{X}; \Theta),
        $$
      </div>
      <br>
      where \( \mathcal{L}_{\text{residual}} \) measures the error in predicted states,
      and \( \mathcal{L}_{\text{constraints}} \) penalizes violations of the algebraic constraints.
      Here, \( X \) are the model-predicted trajectories, and \( \hat{X} \) are the corresponding observations from the training dataset.
    </div>
  </div>
</div>
<!--/ Method -->


<!-- Examples -->
<div class="columns">
  <div class="column is-full-width">
    <h2 class="title is-3">Examples</h2>
    <div class="content has-text-justified">
      Our  Neural DAE framework and all our examples are implemented using the <a href="https://github.com/pnnl/neuromancer" target="_blank">Neuromancer library</a>.
  <br>
      <br>
     Let's consider <strong>tank-manifold-pump system</strong> governed by differential-algebraic equations.
      The goal is to learn the nonlinear area-height profile of a tank, and the implicit flow splitting rule at a manifold junction,
      only from observed time series of tank heights and input flow rates.
  <br>
      <br>
    <a target="_blank" href="https://colab.research.google.com/github/pnnl/NeuralDAEs/blob/master/training/tank_dae_example.ipynb">
      <img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open in Colab" style="height: 30px;"/>
    </a>
    <span>Try this example interactively in <strong>Google Colab</strong></span>
    <br><br>


      In this example, the full DAE system is given by:
      <div style="text-align: center;">
        $$
        \begin{aligned}
        \frac{dx_1}{dt} &= \frac{y_1}{3}, \\
        \frac{dx_2}{dt} &= \frac{y_2}{\sqrt{x_2} + 0.1}, \\
        0 &= u - y_1 - y_2, \\
        0 &= x_1 - x_2,
        \end{aligned}
        $$
      </div>
      <br>
      where \(x_1, x_2\) are the tank heights and \(y_1, y_2\) are the outlet flows.
      The model enforces mass conservation and equal pressure heads through algebraic constraints,
      while learning \(\phi_2(x_2) = \sqrt{x_2} + 0.1\) using a neural network.

      <div class="has-text-centered">
        <img src="./static/images/manifold.png" alt="Tank-manifold schematic" style="max-width: 80%; height: auto;"/>
        <p><em>Figure: Schematic of tank-manifold-pump system.</em></p>
      </div>
      <br>

      The learned model accurately reconstructs the tank heights and flow rates under both training and extrapolation conditions.
  <br>
      <div class="has-text-centered">
        <img src="./static/images/tanks_flows_90.png" alt="Simulation results" style="max-width: 90%; height: auto;"/>
        <p><em>Figure: (a) Tank heights and (b) flow rates during training trajectory with constant inflow through the manifold.</em></p>
      </div>

      <div class="has-text-centered">
        <img src="./static/images/extrap_HeightAreas_flows_90.png" alt="Extrapolation results" style="max-width: 90%; height: auto;"/>
        <p><em>Figure: Extrapolation of learned area-height relationship and resulting flow trajectories under unseen varying inflow through the manifold.</em></p>
      </div>
   <br>

      The model demonstrates the ability to learn interpretable component dynamics while satisfying algebraic constraints and to generalize beyond the training regime.
    </div>
  </div>
</div>
<!--/ Examples -->


    <!-- Conclusion -->
<div class="columns">
  <div class="column is-full-width">
    <h2 class="title is-3">Conclusions and Related Work</h2>
    <div class="content has-text-justified">
      We presented a data-driven framework for learning Differential-Algebraic Equation (DAE) systems using a novel operator splitting strategy.
      By alternating updates between a neural surrogate for algebraic states and a physics-informed ODE solver for differential dynamics,
      the method enables consistent modeling of constrained systems directly from time-series data.
      Our experiments show robustness to noise and extrapolation, with the ability to learn interpretable physical behaviors and interactions among system components.

      <br><br>
      <strong>Future research directions include:</strong>
      <ul>
        <li>Benchmarking against baseline methods such as neural ODEs and PINNs.</li>
        <li>Adapting the framework for stiff or discontinuous dynamics via implicit solvers.</li>
        <li>Extending to higher-index DAEs common in optimal control and system design.</li>
        <li>Handling of partial observability for large-scale systems.</li>
      </ul>

      <br>
      <strong>Related work on neural DAEs:</strong>
    <br>
    <a href="https://www.stochasticlifestyle.com/machine-learning-with-hard-constraints-neural-differential-algebraic-equations-daes-as-a-general-formalism/"
       target="_blank">
      Machine Learning with Hard Constraints: Neural DAEs as a General Formalism
    </a>
    <br>
    <a href="https://arxiv.org/abs/2504.04665" target="_blank">
      A Simultaneous Approach for Training Neural Differential-Algebraic Systems of Equations
    </a>
   <br>

    </div>
  </div>
</div>
<!--/ Conclusion -->



<!-- Acknowledgment -->
<div class="columns">
  <div class="column is-full-width">
    <h2 class="title is-3">Acknowledgment</h2>
    <div class="content has-text-justified">
      This research was supported by the U.S. Department of Energy through the Building Technologies Office under the
      <em>Advancing Market-Ready Building Energy Management by Cost-Effective Differentiable Predictive Control</em> projects.
      Pacific Northwest National Laboratory (PNNL) is a multi-program national laboratory operated for the U.S. Department of Energy (DOE)
      by Battelle Memorial Institute under Contract No. DE-AC05-76RL0-1830.

      <div class="has-text-centered">
        <img src="./static/images/PNNL_logo.jpg" alt="PNNL Logo" style="max-width: 500px; height: auto;"/>
      </div>

      <br>

      This work was also supported by the Ralph Oâ€™Connor Sustainable Energy Institute (ROSEI) at Johns Hopkins University.

      <div class="has-text-centered">
        <img src="./static/images/JHU_logo.png" alt="JHU Logo" style="max-width: 500px; height: auto;"/>
      </div>
    </div>
  </div>
</div>
<!--/ Acknowledgment -->

    </div>
</section>



<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@inproceedings{wu2026piMPC,
      title={piMPC: A Parallel-in-horizon and Construction-free NMPC Solver},
      author={Liang Wu, Bo Yang, Yilin Mo, and Jan Drgona},
      year={2025},
      eprint={2403.12938},
      archivePrefix={arXiv},
      url={https://arxiv.org/abs/2403.12938},
      volume={},
      number={},
}</code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link" href="https://github.com/drgona/NeuralDAEs" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                              href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
           Website based on <a
              href="https://github.com/nerfies/nerfies.github.io">Nerfies template</a>.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>
</body>
</html>
